

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=dark>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/R.png">
  <link rel="icon" href="/img/R.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="Oliver">
  <meta name="keywords" content="">
  
    <meta name="description" content="浏览器内核Trident 俗称IE内核 IE浏览器Gecko 俗称Firefox内核 火狐浏览器Webkit Safari浏览器Blink Chrome浏览器 Oprea浏览器（Blink是由Webkit衍生而来） Cookie、sessionStorage、localStorage的区别共同点：都是保存在浏览器端，并且是同源的 区别：作用域不同 localStorage在所有同源窗口中都是共享的">
<meta property="og:type" content="article">
<meta property="og:title" content="浏览器浅析">
<meta property="og:url" content="http://example.com/2022/08/25/%E6%B5%8F%E8%A7%88%E5%99%A8/%E6%B5%8F%E8%A7%88%E5%99%A8%E9%9D%A2%E8%AF%95/index.html">
<meta property="og:site_name" content="O1ive2&#39;s Studi0">
<meta property="og:description" content="浏览器内核Trident 俗称IE内核 IE浏览器Gecko 俗称Firefox内核 火狐浏览器Webkit Safari浏览器Blink Chrome浏览器 Oprea浏览器（Blink是由Webkit衍生而来） Cookie、sessionStorage、localStorage的区别共同点：都是保存在浏览器端，并且是同源的 区别：作用域不同 localStorage在所有同源窗口中都是共享的">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/pic/pic1.png">
<meta property="article:published_time" content="2022-08-25T07:35:25.000Z">
<meta property="article:modified_time" content="2022-08-25T08:10:34.508Z">
<meta property="article:author" content="Oliver">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://example.com/pic/pic1.png">
  
  
  
  <title>浏览器浅析 - O1ive2&#39;s Studi0</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.9.2","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 6.2.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Fluid</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                分类
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/post.webp') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="浏览器浅析"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2022-08-25 15:35" pubdate>
          2022年8月25日 下午
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          9.3k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          78 分钟
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar category-bar" style="margin-right: -1rem">
    





<div class="category-list">
  
  
    
    
    
    <div class="category row nomargin-x">
      <a class="category-item 
          list-group-item category-item-action col-10 col-md-11 col-xm-11" title="浏览器"
        id="heading-912302cb020149c37f9642fbc9e42891" role="tab" data-toggle="collapse" href="#collapse-912302cb020149c37f9642fbc9e42891"
        aria-expanded="true"
      >
        浏览器
        <span class="list-group-count">(6)</span>
        <i class="iconfont icon-arrowright"></i>
      </a>
      
      <div class="category-collapse collapse show" id="collapse-912302cb020149c37f9642fbc9e42891"
           role="tabpanel" aria-labelledby="heading-912302cb020149c37f9642fbc9e42891">
        
        
          
  <div class="category-post-list">
    
    
      
      
        <a href="/2022/08/25/%E6%B5%8F%E8%A7%88%E5%99%A8/cookie.seesion.token.jwt/" title="cookie、session、token浅析"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">cookie、session、token浅析</span>
        </a>
      
    
      
      
        <a href="/2022/08/25/%E6%B5%8F%E8%A7%88%E5%99%A8/get,post/" title="get、post"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">get、post</span>
        </a>
      
    
      
      
        <a href="/2022/08/25/%E6%B5%8F%E8%A7%88%E5%99%A8/%E5%A6%82%E4%BD%95%E8%A7%A3%E6%9E%90js/" title="如何解析js"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">如何解析js</span>
        </a>
      
    
      
      
        <a href="/2022/08/25/%E6%B5%8F%E8%A7%88%E5%99%A8/%E6%B5%8F%E8%A7%88%E5%99%A8%E9%9D%A2%E8%AF%95/" title="浏览器浅析"
           class="list-group-item list-group-item-action
           active">
          <span class="category-post">浏览器浅析</span>
        </a>
      
    
      
      
        <a href="/2022/08/25/%E6%B5%8F%E8%A7%88%E5%99%A8/%E7%BA%BF%E7%A8%8B/" title="线程及其机制"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">线程及其机制</span>
        </a>
      
    
      
      
        <a href="/2022/08/25/%E6%B5%8F%E8%A7%88%E5%99%A8/%E7%BC%93%E5%AD%98/" title="缓存"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">缓存</span>
        </a>
      
    
  </div>

        
      </div>
    </div>
  
</div>


  </aside>


    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">浏览器浅析</h1>
            
            
              <div class="markdown-body">
                
                <h1 id="浏览器内核"><a href="#浏览器内核" class="headerlink" title="浏览器内核"></a>浏览器内核</h1><p>Trident 俗称IE内核 IE浏览器<br>Gecko 俗称Firefox内核 火狐浏览器<br>Webkit Safari浏览器<br>Blink Chrome浏览器 Oprea浏览器（Blink是由Webkit衍生而来）</p>
<h1 id="Cookie、sessionStorage、localStorage的区别"><a href="#Cookie、sessionStorage、localStorage的区别" class="headerlink" title="Cookie、sessionStorage、localStorage的区别"></a>Cookie、sessionStorage、localStorage的区别</h1><p>共同点：都是保存在浏览器端，并且是同源的</p>
<p>区别：作用域不同</p>
<p>localStorage在所有同源窗口中都是共享的，同浏览器无法共享local和session的信息，同浏览器下，local可以在不同页面 (指的是相同域名和端口的下的不同页面) 共享相同的local数据，</p>
<p>sessionStorage不在不同的浏览器窗口中共享，即使是同一个页面，不同页面或标签页间无法共享sessionStorage的信息，需要注意页面及标签页仅指顶级窗口，如果一个标签页包含多个iframe标签且他们属于同源页面，那么他们之间是可以共享sessionStorage的</p>
<p>cookie也是在所有同源窗口中都是共享的，cookie在不设置过期时间的前提下，只在当前的会话有效，</p>
<h2 id="sessionStorage"><a href="#sessionStorage" class="headerlink" title="sessionStorage"></a>sessionStorage</h2><p>仅在当前浏览器窗口关闭前有效，自然也就不可能持久保持，cookie只在设置的cookie过期时间之前一直有效，即使窗口或浏览器关闭。（key：本身就是一个回话过程，关闭浏览器后消失，session为一个回话，当页面不同即使是同一页面打开两次，也被视为同一次回话）</p>
<h2 id="localStorage"><a href="#localStorage" class="headerlink" title="localStorage"></a>localStorage</h2><p>localStorage：始终有效，窗口或浏览器关闭也一直保存，因此用作持久数据；<br>localStorage 在所有同源窗口中都是共享的；cookie也是在所有同源窗口中都是共享的。（key：同源窗口都会共享，并且不会失效，不管窗口或者浏览器关闭与否都会始终生效）</p>
<h2 id="Cookie"><a href="#Cookie" class="headerlink" title="Cookie"></a>Cookie</h2><p>分为 seesion cookies（会话cookie，临时）和 permanent cookies （持久cookie）</p>
<p>默认在浏览器关闭时，会话cookie删除</p>
<p>cookie数据始终在同源的http请求中携带（即使不需要），即cookie在浏览器和服务器间来回传递。而sessionStorage和localStorage不会自动把数据发给服务器，仅在本地保存。cookie数据还有路径（path）的概念，可以限制cookie只属于某个路径下,存储的大小很小只有4K左右。 （key：可以在浏览器和服务器端来回传递，存储容量小，只有大约4K左右）<br>cookie属性：</p>
<pre><code class="hljs">Domain(域)：Cookie的域；浏览器只向指定域中的服务器主机名发送Cookie，这样服务器就将Cookie限制在了特定的域中。jianshu.com域就与jianshu1.jianshu.com和jianshu1.jianshu2.jianshu.com相匹配，但与js.com就不匹配了。

Path(路径)：通过这个属性可以为服务器上特定的文档分配Cookie，如果Path属性是一个URL路径前缀，就可以附加一个Cookie，路径/foo，与/foobar和foo/bar.html相匹配，路径&quot;/&quot;与域名中所有的内容都匹配。

Secure(安全)：是否只有在HTTP使用SSL连接时才发送这个Cookie；

expires(过期)：从格林尼治标准时间1970年1月1日00：00：00开始的过期秒数；如果不设置该属性，或者设为null，Cookie 只在当前会话（session）有效，浏览器窗口一旦关闭，当前 Session 结束，该 Cookie 就会被删除。另外，浏览器根据本地时间，决定 Cookie 是否过期，由于本地时间是不精确的，所以没有办法保证 Cookie 一定会在服务器指定的时间过期。

name(名字)：Cookie变量的名字；

value(值)：Cookie变量的值；
</code></pre>
<p><img src="/pic/pic1.png" srcset="/img/loading.gif" lazyload alt="pic1"></p>
<p>用户访问网址<a target="_blank" rel="noopener" href="http://www.example.com,服务器在浏览器写入一个/">www.example.com，服务器在浏览器写入一个</a> Cookie。这个 Cookie 就会包含<a target="_blank" rel="noopener" href="http://www.example.com这个域名,以及根路径/%E3%80%82%E8%BF%99%E6%84%8F%E5%91%B3%E7%9D%80%EF%BC%8C%E8%BF%99%E4%B8%AA">www.example.com这个域名，以及根路径/。这意味着，这个</a> Cookie 对该域名的根路径和它的所有子路径都有效。如果路径设为&#x2F;forums，那么这个 Cookie 只有在访问<a target="_blank" rel="noopener" href="http://www.example.com/forums%E5%8F%8A%E5%85%B6%E5%AD%90%E8%B7%AF%E5%BE%84%E6%97%B6%E6%89%8D%E6%9C%89%E6%95%88%E3%80%82%E4%BB%A5%E5%90%8E%EF%BC%8C%E6%B5%8F%E8%A7%88%E5%99%A8%E4%B8%80%E6%97%A6%E8%AE%BF%E9%97%AE%E8%BF%99%E4%B8%AA%E8%B7%AF%E5%BE%84%EF%BC%8C%E6%B5%8F%E8%A7%88%E5%99%A8%E5%B0%B1%E4%BC%9A%E9%99%84%E4%B8%8A%E8%BF%99%E6%AE%B5">www.example.com/forums及其子路径时才有效。以后，浏览器一旦访问这个路径，浏览器就会附上这段</a> Cookie 发送给服务器。</p>
<p>浏览器可以设置不接受 Cookie，也可以设置不向服务器发送 Cookie</p>
<h3 id="http回应：cookie的生成"><a href="#http回应：cookie的生成" class="headerlink" title="http回应：cookie的生成"></a>http回应：cookie的生成</h3><p>服务器如果希望在浏览器保存 Cookie，就要在 HTTP 回应的头信息里面，放置一个Set-Cookie字段</p>
<h3 id="cookie和session的区别"><a href="#cookie和session的区别" class="headerlink" title="cookie和session的区别"></a>cookie和session的区别</h3><p>1、cookie数据存放在客户的浏览器上，session数据放在服务器上。（session创建于服务器端，保存于服务器，维护于服务器，每创建一个新的Session，服务器端都会分配一个唯一的ID，并且把这个ID保存到客户端的Cookie中，保存形式是以JsessionID来保存的。）<br>2、cookie不是很安全，别人可以分析存放在本地的cookie并进行cookie欺骗，考虑到安全应当使用session。<br>3、session会在一定时间内保存在服务器上。当访问增多，会比较占用你服务器的性能，考虑到减轻服务器性能方面，应当使用cookie。<br>4、单个cookie保存的数据不能超过4K，很多浏览器都限制一个站点最多保存20个cookie。<br>5、可以考虑将登陆信息等重要信息存放为session，其他信息如果需要保留，可以放在cookie中</p>
<hr>

<h2 id="跨域"><a href="#跨域" class="headerlink" title="跨域"></a>跨域</h2><p>当一个请求的协议、域名、端口三者之间任意一个与当前页面url不同即为跨域<br>为什么会出现跨域问题：<br>出于浏览器的同源策略限制。同源策略（Sameoriginpolicy）是一种约定，它是浏览器最核心也最基本的安全功能，如果缺少了同源策略，则浏览器的正常功能可能都会受到影响，可能会受到XSS,CSFR等攻击</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs awk">URL                                      说明                    是否允许通信<br>http:<span class="hljs-regexp">//</span>www.domain.com/a.js<br>http:<span class="hljs-regexp">//</span>www.domain.com/b.js         同一域名，不同文件或路径           允许<br>http:<span class="hljs-regexp">//</span>www.domain.com<span class="hljs-regexp">/lab/</span>c.js<br><br>http:<span class="hljs-regexp">//</span>www.domain.com:<span class="hljs-number">8000</span>/a.js<br>http:<span class="hljs-regexp">//</span>www.domain.com/b.js         同一域名，不同端口                不允许<br> <br>http:<span class="hljs-regexp">//</span>www.domain.com/a.js<br>https:<span class="hljs-regexp">//</span>www.domain.com/b.js        同一域名，不同协议                不允许<br> <br>http:<span class="hljs-regexp">//</span>www.domain.com/a.js<br>http:<span class="hljs-regexp">//</span><span class="hljs-number">192.168</span>.<span class="hljs-number">4.12</span>/b.js           域名和域名对应相同ip              不允许<br> <br>http:<span class="hljs-regexp">//</span>www.domain.com/a.js<br>http:<span class="hljs-regexp">//</span>x.domain.com/b.js           主域相同，子域不同                不允许<br>http:<span class="hljs-regexp">//</span>domain.com/c.js<br> <br>http:<span class="hljs-regexp">//</span>www.domain1.com/a.js<br>http:<span class="hljs-regexp">//</span>www.domain2.com/b.js        不同域名                         不允许<br><br></code></pre></td></tr></table></figure>

<h2 id="如何解决跨域"><a href="#如何解决跨域" class="headerlink" title="如何解决跨域"></a>如何解决跨域</h2><p>1.jsonp，缺点，只能实现get一种请求</p>
<p>2.cors跨域，目前所有浏览器都支持该功能，cors也成为了主流的跨域解决方案</p>
<p>3.代理跨域，启动一个代理服务器，实现数据的转发</p>
<h2 id="jsonp跨域原理"><a href="#jsonp跨域原理" class="headerlink" title="jsonp跨域原理"></a>jsonp跨域原理</h2><p>script资源不受同源策略限制<br>script标签允许访问不同源<br>JSONP利用script标签的加载机制，发送的不是ajax请求，通过script标签获取资源，但是获取的非json数据，而是js格式的数据，所以需要在回调函数中将js解析为json<br>服务器需要返回js格式的数据<br>服务器和客户端都需要配置<br>优点：兼容性好<br>缺点：只支持get请求</p>
<h2 id="cors跨域原理"><a href="#cors跨域原理" class="headerlink" title="cors跨域原理"></a>cors跨域原理</h2><p>cors跨域只需要在服务端进行配置</p>
<p>跨域资源共享，基本思想是使用自定义的HTTP头部让浏览器和服务器通信</p>
<p>分类：浏览器将cors分为两类</p>
<p>简单请求(head get post)<br>非简单请求</p>
<h3 id="简单请求-head-get-post"><a href="#简单请求-head-get-post" class="headerlink" title="简单请求(head get post)"></a>简单请求(head get post)</h3><p>客户端在request头部添加一个origin字段，用来说明请求来自哪个源（协议，域名，端口），服务器根据这个值决定是否同意<br>如果服务器不许可，则返回的信息中不会包含Access-Control-Allow-Origin字段，这个错误需要onerror捕获，返回的状态码可能为200<br>如果服务器许可，则服务器返回的响应中会多出Access-Control-Allow-Origin、Access-Control-Allow-Credentials等字段<br>CORS默认不发送cookie，需要发送cookies，则需要服务器指定Access-Control-Allow-Credentials字段，需要在ajax请求中打开withCredentials属性</p>
<h3 id="非简单请求"><a href="#非简单请求" class="headerlink" title="非简单请求"></a>非简单请求</h3><p>会在正式通信前，增加一次OPTIONS查询请求，预检请求</p>
<p>简单请求需要CORS服务端对OPTIONS类型的请求做处理，其他与简单请求一致<br>询问服务器，网页所在域名是否在服务器的许可名单中，以及可以使用那些HTTP动词和头信息字段，只有得到肯定答复，浏览器才会发出正式XMLHTTPRequest请求，否则会报错<br>服务器通过预检请求，以后每次浏览器正常CORS请求，都会和简单请求一样，会有一个Origin字段，服务器的回应也会有yieldAccess-Control-Allow-Origin头信息字段</p>
<h2 id="设置反向代理"><a href="#设置反向代理" class="headerlink" title="设置反向代理"></a>设置反向代理</h2><p>客户端在3000端口</p>
<p>服务器在5000，</p>
<p>发送请求到达服务器，由于客户端有ajax返回数据时会卡住</p>
<p>此时配置代理在3000，由于代理是服务端，没有ajax引擎，因此代理可以接受到5000返回的数据</p>
<hr>

<h2 id="输入url到显示页面这个过程发生了什么"><a href="#输入url到显示页面这个过程发生了什么" class="headerlink" title="输入url到显示页面这个过程发生了什么"></a>输入url到显示页面这个过程发生了什么</h2><p>DNS解析<br>TCP连接<br>发送HTTP请求<br>服务器处理请求并返回HTTP报文<br>浏览器解析渲染页面<br>连接结束<br>详细描述</p>
<p>1.根据URL域名寻找服务器ip，浏览器 <code>&lt;font color=red&gt;</code>首先在缓存中查找 <code>&lt;/font&gt;</code>，查找的顺序是浏览器缓存→系统缓存→路由器缓存，缓存中查找不到则去 <code>&lt;font color=red&gt;</code>系统的hosts文件中查找 <code>&lt;/font&gt;</code>，没有则 <code>&lt;font color=red&gt;</code>查询DNS服务器 <code>&lt;/font&gt;</code><br>2.得到ip地址后，接下来介绍向服务器发送 HTTP 请求阶段，HTTP 请求分为三个部分：TCP 三次握手、http 请求响应信息。浏览器根据ip和相应端口号.<code>&lt;font color=red&gt;</code>构建一个http请求 <code>&lt;/font&gt;</code>并将该http请求 <code>&lt;font color=red&gt;</code>封装在一个tcp包中 <code>&lt;/font&gt;</code>，这个tcp包依次经过传输层、网络层、数据链路层、物理层到达服务器，<code>&lt;font color=red&gt;</code>服务器解析 <code>&lt;/font&gt;</code>这个请求并作出响应，返回相应的html给浏览器<br>3.浏览器根据返回的html来 <code>&lt;font color=red&gt;</code>构建DOM树 <code>&lt;/font&gt;</code>，构建DOM树的过程中如果遇到图片、音视频等资源会并行下载，如果遇到js脚本或外部js连接，则会停止DOM树的构建去执行和下载相应js脚本，这会造成 <code>&lt;font color=red&gt;</code>阻塞 <code>&lt;/font&gt;</code>；之后根据外部样式、内部样式、内联样式构建CSSOM树，构建完成后和DOM树合并成渲染树，主要目的是排除非视觉节点，比如script、meta标签和排除display为none的节点<br>4.进行布局，确定各个元素的位置和尺寸，然后渲染页面，显示给用户<br>5.、关闭 TCP 连接,tcp四次挥手<br>5.上述所有请求中都会涉及http缓存机制</p>
<hr>

<h2 id="浏览器渲染过程"><a href="#浏览器渲染过程" class="headerlink" title="浏览器渲染过程"></a>浏览器渲染过程</h2><p>1.浏览器会将HTML解析成一个DOM树<br>    ~根据 HTML 的内容，将标签按照结构解析成为 DOM 树，DOM 树解析的过程是一个深度优先遍历。即先构建当前节点的所有子节点，再构建下一个兄弟节点。<br>    ~在读取 HTML 文档，构建 DOM 树的过程中，若遇到 script 标签，则 DOM 树的构建会暂停，直至脚本执行完毕</p>
<p>2.将CSS解析成 CSS Rule Tree<br>-解析 CSS 规则树时 js 执行将暂停，直至 CSS 规则树就绪。<br>-浏览器在 CSS 规则树生成之前不会进行渲染。</p>
<p>3.根据DOM树和CSSOM来构造 Rendering Tree<br>-DOM 树和 CSS 规则树全部准备好了以后，浏览器才会开始构建渲染树。<br>-精简 CSS 并可以加快 CSS 规则树的构建，从而加快页面相应速度。</p>
<p>4.有了Rendering Tree，浏览器已经能知道网页中有哪些节点、各个节点的CSS定义以及他们的从属关系。下一步操作称之为布局layout，顾名思义就是计算出每个节点在屏幕中的位置<br>-布局：通过渲染树中渲染对象的信息，计算出每一个渲染对象的位置和尺寸<br>-回流：在布局完成后，发现了某个部分发生了变化影响了布局，那就需要倒回去重新渲染。</p>
<p>5.再下一步就是绘制，将Rendering Tree的各个节点绘制到屏幕上<br>-绘制阶段，系统会遍历呈现树，并调用呈现器的“paint”方法，将呈现器的内容显示在屏幕上。<br>-重绘：某个元素的背景颜色，文字颜色等，不影响元素周围或内部布局的属性，将只会引起浏览器的重绘。<br>-回流：某个元素的尺寸发生了变化，则需重新计算渲染树，重新渲染。</p>
<hr>

<h2 id="手写Ajax"><a href="#手写Ajax" class="headerlink" title="手写Ajax"></a>手写Ajax</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs js">funtion <span class="hljs-title function_">ajax</span>(<span class="hljs-params">url</span>)&#123;<br>    <span class="hljs-comment">//1.创建ajax对象</span><br>    <span class="hljs-keyword">var</span> xhr = <span class="hljs-keyword">new</span> <span class="hljs-title class_">XMLHttpRequest</span>()<br>    <span class="hljs-comment">//2.连接服务器,open(方法、文件名、异步传输）</span><br>    <span class="hljs-comment">//方法：传输方式是get方式还是post方式。</span><br>    <span class="hljs-comment">//文件名：告诉服务器要读哪个文件</span><br>    <span class="hljs-comment">//异步传输：1.异步：多件事一件一件的做；2.同步：多件事情一起进行</span><br>    <span class="hljs-comment">//但是js里面的同步和异步和现实的同步异步相反。1.同步：多件事一件一件的做；2.异步：多件事情一起进行</span><br>    xhr.<span class="hljs-title function_">open</span>(<span class="hljs-string">&#x27;get&#x27;</span>, url, <span class="hljs-literal">true</span>)<br>    <span class="hljs-comment">//3.发送请求</span><br>    xhr.<span class="hljs-title function_">send</span>()<br>    <span class="hljs-comment">//4.接收返回,客户端和服务器端有交互的时候会调用onreadystatechange</span><br>    xhr.<span class="hljs-property">onreadyStatechange</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br>        <span class="hljs-keyword">if</span>(xhr.<span class="hljs-property">readyState</span> == <span class="hljs-number">4</span>)&#123;<span class="hljs-comment">//未初始化 ，没有发送send 1  载入开始 调用send 发起请求  2  载入完成 send完成 收到响应内容 3  交互 解析系响应内容 4  完成</span><br>            <span class="hljs-keyword">if</span>(xhr.<span class="hljs-property">status</span> == <span class="hljs-number">200</span>)&#123;<br>                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;成功&#x27;</span>+xhr.<span class="hljs-property">responseText</span>)<br>            &#125;<span class="hljs-keyword">else</span>&#123;<br>                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;失败&#x27;</span>)<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs scss">状态值	描述<br><span class="hljs-number">0</span>	请求还未初始化，还未调用<span class="hljs-built_in">open</span>( )<br><span class="hljs-number">1</span>	请求已建立但未发送，还未调用<span class="hljs-built_in">send</span>( )<br><span class="hljs-number">2</span>	接受原始响应数据，为解析做准备<br><span class="hljs-number">3</span>	正在解析数据,根据响应头部返回的MIME类型把数据转换成能通过responseText等形式存取的格式<br><span class="hljs-number">4</span>	响应完成，数据解析完成<br></code></pre></td></tr></table></figure>

<hr>

<h2 id="提升页面性能"><a href="#提升页面性能" class="headerlink" title="提升页面性能"></a>提升页面性能</h2><ul>
<li>资源压缩合并，减少HTTP请求</li>
<li>使用CDN，内容分发网络</li>
<li>预解析DNS</li>
<li>非核心代码异步加载</li>
</ul>
<hr>
<h2 id="浏览器缓存"><a href="#浏览器缓存" class="headerlink" title="浏览器缓存"></a>浏览器缓存</h2><p>缓存策略都是通过设置 HTTP Header 来实现的。<br>缓存策略的分类：</p>
<h3 id="强缓存"><a href="#强缓存" class="headerlink" title="强缓存"></a>强缓存</h3><p>强缓存：不会向服务器发送请求，直接从缓存中读取资源，在chrome控制台的Network选项中可以看到该请求返回200的状态码，并且Size显示from disk cache或from memory cache。强缓存可以通过设置两种 HTTP Header 实现：Expires 和 Cache-Control。</p>
<p>Expires<br>缓存过期时间，用来指定资源到期的时间，是服务器端的具体的时间点。Expires是Web服务器响应消息头字段，在响应http请求时告诉浏览器在过期时间前浏览器可以直接从浏览器缓存取数据，而无需再次请求。</p>
<p>Cache-Control<br>在HTTP&#x2F;1.1中，Cache-Control是最重要的规则，主要用于控制网页缓存。比如当 Cache-Control:max-age&#x3D;300 时，则代表在这个请求正确返回时间（浏览器也会记录下来）的5分钟内再次加载资源，就会命中强缓存。</p>
<p>Expires和Cache-Control两者区别<br>其实这两者差别不大，区别就在于 Expires 是http1.0的产物，Cache-Control是http1.1的产物，两者同时存在的话，Cache-Control优先级高于Expires ；</p>
<h3 id="协商缓存"><a href="#协商缓存" class="headerlink" title="协商缓存"></a>协商缓存</h3><p>协商缓存就是强制缓存失效后，浏览器携带缓存标识向服务器发起请求，由服务器根据缓存标识决定是否使用缓存的过程，主要有以下两种情况：</p>
<p>协商缓存生效，返回304和Not Modified<br>协商缓存失效，返回200和请求结果</p>
<p>协商缓存可以通过设置两种 HTTP Header 实现：Last-Modified 和 ETag 。</p>
<p>Last-Modified和If-Modified-Since<br>浏览器在第一次访问资源时，服务器返回资源的同时，在response header中添加 Last-Modified 的header，值是这个资源在服务器上的最后修改时间，浏览器接收后缓存文件和 header；浏览器下一次请求这个资源，浏览器检测到有 Last-Modified这个header，于是添加If-Modified-Since这个header，值就是Last-Modified中的值；服务器再次收到这个资源请求，会根据 If-Modified-Since 中的值与服务器中这个资源的最后修改时间对比，如果没有变化，返回304和空的响应体，直接从缓存读取，如果If-Modified-Since的时间小于服务器中这个资源的最后修改时间，说明文件有更新，于是返回新的资源文件和200。</p>
<p>ETag和If-None-Match<br>Etag 是服务器响应请求时，返回当前资源文件的一个唯一标识(由服务器生成)，只要资源有变化，Etag就会重新生成。浏览器在下一次加载资源向服务器发送请求时，会将上一次返回的Etag值放到request header里的If-None-Match里，服务器只需要比较客户端传来的If-None-Match跟自己服务器上该资源的ETag是否一致，就能很好地判断资源相对客户端而言是否被修改过了。如果服务器发现ETag匹配不上，那么直接以常规GET 200回包形式将新的资源（当然也包括了新的ETag）发给客户端；如果ETag是一致的，则直接返回304知会客户端直接使用本地缓存即可。</p>
<h3 id="两者之间对比"><a href="#两者之间对比" class="headerlink" title="两者之间对比"></a>两者之间对比</h3><p>首先在精确度上，Etag要优于Last-Modified。<br>第二在性能上，Etag要逊于Last-Modified，毕竟Last-Modified只需要记录时间，而Etag需要服务器通过算法来计算出一个hash值。<br>第三在优先级上，服务器校验优先考虑Etag</p>
<h3 id="缓存机制"><a href="#缓存机制" class="headerlink" title="缓存机制"></a>缓存机制</h3><p>强制缓存优先于协商缓存进行，若强制缓存(Expires和Cache-Control)生效则直接使用缓存，若不生效则进行协商缓存(Last-Modified &#x2F; If-Modified-Since和Etag &#x2F; If-None-Match)，协商缓存由服务器决定是否使用缓存，若协商缓存失效，那么代表该请求的缓存失效，返回200，重新返回资源和缓存标识，再存入浏览器缓存中；生效则返回304，继续使用缓存。</p>
<h3 id="from-memory-cache和from-disk-cache的区别"><a href="#from-memory-cache和from-disk-cache的区别" class="headerlink" title="from memory cache和from disk cache的区别"></a>from memory cache和from disk cache的区别</h3><p>在chrome浏览器中的控制台Network中size栏通常会有三种状态<br>1.from memory cache<br>2.from disk cache<br>3.资源本身的大小(如：1.5k)<br>三种的区别：</p>
<p>from memory cache ：字面理解是从内存中，其实也是字面的含义，这个资源是直接从内存中拿到的，不会请求服务器一般已经加载过该资源且缓存在了内存当中，当关闭该页面时，此资源就被内存释放掉了，再次重新打开相同页面时不会出现from memory cache的情况。<br>from disk cache ：同上类似，此资源是从磁盘当中取出的，也是在已经在之前的某个时间加载过该资源，不会请求服务器但是此资源不会随着该页面的关闭而释放掉，因为是存在硬盘当中的，下次打开仍会from disk cache<br>资源本身大小数值 ：当http状态为200是实实在在从浏览器获取的资源，当http状态为304时该数字是与服务端通信报文的大小，并不是该资源本身的大小，该资源是从本地获取的</p>
<hr>
<h2 id="前端中的事件流"><a href="#前端中的事件流" class="headerlink" title="前端中的事件流"></a>前端中的事件流</h2><p>事件流描述的是从页面中接收事件的顺序<br>事件捕获：当某个元素触发某个事件（如onclick），顶层对象document就会发出一个事件流，随着DOM树的节点向目标元素节点流去，直到到达事件真正发生的目标元素。在这个过程中，事件相应的监听函数是不会被触发的。<br>事件目标：当到达目标元素之后，执行目标元素该事件相应的处理函数。如果没有绑定监听函数，那就不执行。<br>事件冒泡：从目标元素开始，往顶层元素传播。途中如果有节点绑定了相应的事件处理函数，这些函数都会被依次触发。<br>事件流的3个阶段：</p>
<ul>
<li>事件捕获阶段（事件从 Document 节点 自上而下 向目标节点传播的阶段）<br>捕获的流程为：window -&gt; document -&gt; html -&gt; body -&gt; … -&gt; 目标元素。</li>
<li>处于目标阶段（真正的目标节点正在处理事件的阶段）</li>
<li>事件冒泡阶段（事件从目标节点 自下而上 向 Document 节点传播的阶段）<br>冒泡的流程为：目标元素 -&gt; … -&gt; body -&gt; html -&gt; document -&gt; window。<br>阻止事件的默认行为</li>
<li>return false</li>
<li>event.preventDefault()<br>阻止事件冒泡</li>
<li>return false</li>
<li>w3c：event.stopPropagation()</li>
<li>ie：event.cancelBubble &#x3D; true<br>阻止剩下的事件处理程序被执行。如果一个元素上绑定了三个事件，在其中一个事件上调用了这个方法，那其他 的两个事件将不会被执行。</li>
<li>event.stopImmediatePropagation()</li>
</ul>
<hr>
<h2 id="图片的懒加载和预加载"><a href="#图片的懒加载和预加载" class="headerlink" title="图片的懒加载和预加载"></a>图片的懒加载和预加载</h2><p>预加载：提前加载图片，当用户需要查看时可直接从本地缓存中渲染。<br>懒加载：懒加载的主要目的是作为服务器前端的优化，减少请求数或延迟请求数。<br>两种技术的本质：两者的行为是相反的，一个是提前加载，一个是迟缓甚至不加载。  懒加载对服务器前端有一定的缓解压力作用，预加载则会增加服务器前端压力</p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/%E6%B5%8F%E8%A7%88%E5%99%A8/" class="category-chain-item">浏览器</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>浏览器浅析</div>
      <div>http://example.com/2022/08/25/浏览器/浏览器面试/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>Oliver</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2022年8月25日</div>
        </div>
      
      
      <div class="license-meta-item">
        <div>许可协议</div>
        <div>
          
            
            
              <a target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
              <span class="hint--top hint--rounded" aria-label="BY - 署名">
                <i class="iconfont icon-by"></i>
              </span>
              </a>
            
          
        </div>
      </div>
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2022/08/25/%E6%B5%8F%E8%A7%88%E5%99%A8/%E7%BC%93%E5%AD%98/" title="缓存">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">缓存</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2022/08/25/javascript/var%E3%80%81let%E3%80%81const/" title="var、let、const区别">
                        <span class="hidden-mobile">var、let、const区别</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      headingSelector : CONFIG.toc.headingSelector || 'h1,h2,h3,h4,h5,h6',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      collapseDepth   : CONFIG.toc.collapseDepth || 0,
      scrollSmooth    : true,
      headingsOffset  : -boardTop
    });
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.10/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
